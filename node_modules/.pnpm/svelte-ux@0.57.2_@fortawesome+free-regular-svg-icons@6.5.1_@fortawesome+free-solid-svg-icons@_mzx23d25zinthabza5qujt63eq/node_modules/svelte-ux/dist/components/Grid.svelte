<script>import { cssVars } from '../actions/cssVars';
export let columns = 0;
export let gap = 0;
export let columnGap = gap;
export let rowGap = gap;
export let autoFlow = 'row';
export let autoColumns = null;
export let template = null;
export let templateColumns = null;
export let templateRows = null;
export let stack = false;
export let inline = false;
export let items = 'initial';
export let justify = 'initial';
export let justifyItems = 'initial';
export let content = 'initial';
// TODO: place-items overrides/conflicts with align-items
// export let place:
//   | 'start'
//   | 'end'
//   | 'center'
//   | 'between'
//   | 'around'
//   | 'evenly'
//   | 'initial' = 'initial';
$: templateColumnsResolved =
    templateColumns ??
        template ??
        (autoColumns ? `repeat(auto-fill, minmax(${autoColumns}, 1fr))` : `repeat(${columns}, 1fr)`);
$: styleVars = {
    templateColumns: templateColumnsResolved,
    templateRows,
    gap,
    columnGap,
    rowGap,
    autoFlow,
    items,
    justify,
    justifyItems,
    content, // TODO: Map start: flex-start?, end: flex-end?, between: space-between, around: space-around, evenly: space-evenly
    // place, // TODO: Map start: flex-start?, end: flex-end?, between: space-between, around: space-around, evenly: space-evenly
};
</script>

<div
  use:cssVars={styleVars}
  class="Grid"
  class:grid={!inline}
  class:inline-grid={inline}
  class:stack
  on:click
  {...$$restProps}
>
  <slot />
</div>

<style>
  div {
    grid-template-columns: var(--templateColumns);
    grid-template-rows: var(--templateRows);
    grid-gap: calc(1px * var(--gap));
    grid-column-gap: calc(1px * var(--columnGap));
    grid-row-gap: calc(1px * var(--rowGap));
    grid-auto-flow: var(--autoFlow);
    align-items: var(--items);
    justify-content: var(--justify);
    justify-items: var(--justifyItems);
    align-content: var(--content);
    /* place-items: var(--place); */
  }

  .stack > :global(*) {
    grid-area: 1 / 1;
  }
</style>
